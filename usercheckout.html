
<!DOCTYPE html>
<html lang="en">

<head>
    <title>Ospek Malang</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="csrf-token" content="jhGnK4mUzq5jKoSbVALk1WGiTUc5g0agt5G0rwBg">

    <!--===============================================================================================-->
    <link rel="icon" type="image/png" href="images/icons/favicon.png" />
    <!--===============================================================================================-->
    <link rel="stylesheet" type="text/css" href="vendor/bootstrap/css/bootstrap.min.css">
    <!--===============================================================================================-->
    <link rel="stylesheet" type="text/css" href="fonts/font-awesome-4.7.0/css/font-awesome.min.css">
    <!--===============================================================================================-->
    <link rel="stylesheet" type="text/css" href="fonts/iconic/css/material-design-iconic-font.min.css">
    <!--===============================================================================================-->
    <link rel="stylesheet" type="text/css" href="fonts/linearicons-v1.0.0/icon-font.min.css">
    <!--===============================================================================================-->
    <link rel="stylesheet" type="text/css" href="vendor/animate/animate.css">
    <!--===============================================================================================-->
    <link rel="stylesheet" type="text/css" href="vendor/css-hamburgers/hamburgers.min.css">
    <!--===============================================================================================-->
    <link rel="stylesheet" type="text/css" href="vendor/animsition/css/animsition.min.css">
    <!--===============================================================================================-->
    <link rel="stylesheet" type="text/css" href="vendor/select2/select2.min.css">
    <!--===============================================================================================-->
    <link rel="stylesheet" type="text/css" href="vendor/daterangepicker/daterangepicker.css">
    <!--===============================================================================================-->
    <link rel="stylesheet" type="text/css" href="vendor/slick/slick.css">
    <!--===============================================================================================-->
    <link rel="stylesheet" type="text/css" href="vendor/MagnificPopup/magnific-popup.css">
    <!--===============================================================================================-->
    <link rel="stylesheet" type="text/css" href="vendor/perfect-scrollbar/perfect-scrollbar.css">

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">

    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <!--===============================================================================================-->
    <link rel="stylesheet" type="text/css" href="css/style.css">
    <link rel="stylesheet" type="text/css" href="css/mained.css">
    <script src="js/sekerip.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css"
        integrity="sha512-Kc323vGBEqzTmouAECnVceyQqyqdsSiqLQISBL29aUW4U/M7pSPA/gEUZQqv1cwx4OnYxTxve5UMg5GT6L4JJg=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />
    <!--===============================================================================================-->
    <script src="https://app.sandbox.midtrans.com/snap/snap.js" data-client-key="SB-Mid-client-1AopBxYsml-S9bqk"></script>
        
</head>

    <body>
        <header>
    <div class="container-menu-desktop">
        <div class="wrap-menu-desktop" style="top: 0;">
            <nav class="limiter-menu-desktop container">
                <!-- Logo desktop -->
                <a href="#" class="logo">
                    <img src="images/logo.png" alt="IMG-LOGO">
                </a>

                <!-- Menu desktop -->
                <div class="menu-desktop">
                    <ul class="main-menu">
                        <li class="active-menu">
                            <a href="user">Beranda</a>
                        </li>
                        <li>
                            <a href="user#about">Tentang</a>
                        </li>
                        <li>
                            <a href="user/product">Produk</a>
                        </li>
                    </ul>
                </div>

                <!-- Icon header -->
                <div class="wrap-icon-header flex-w flex-r-m">
                    <div class="icon-header-item cl2 hov-cl1 trans-04 p-l-22 p-r-11">
                        <form action="" class="search">
                            <input type="search" placeholder="Cari..." class="search-input">
                            <button type="submit" class="search-btn">
                                <i class="fa-solid fa-magnifying-glass"></i>
                            </button>
                        </form>
                    </div>

                    <div class="icon-header-item cl2 hov-cl1 trans-04 p-r-11 p-l-10 icon-header-noti js-show-cart"
                        data-notify="1">
                        <i class="zmdi zmdi-shopping-cart"></i>
                    </div>

                    <!-- Profile dropdown menu -->
                    <div class="profile-image">
                                                    <img src="images/default-profile.jpg" alt="Default Image">
                                                <ul class="menu-profil">
                            <a href="user/profile">
                            <li class="profil-list">
                                    <span class="tittle">Edit Profil</span>
                                </li>
                            </a>
                            <a href="user/order">
                            <li class="profil-list">
                                    <span class="tittle">Pesanan</span>
                                </li>
                            </a>
                                                                                    <a href="admin">
                                <li class="profil-list">
                                        <span>Panel Admin</span>
                                    </li>
                                </a>
                                                                            <a href="#"
                            onclick="event.preventDefault(); document.getElementById('logout-form').submit();">
                            <li class="profil-list">
                                <form id="logout-form" action="logout" method="POST">
                                    <input type="hidden" name="_token" value="jhGnK4mUzq5jKoSbVALk1WGiTUc5g0agt5G0rwBg" autocomplete="off">                                </form>
                                    <span class="tittle">Keluar</span>
                                </li>
                            </a>
                        </ul>
                    </div>
                </div>
            </nav>
        </div>
    </div>
</header>

        <!-- Alamat Pengiriman -->
        <div class="checkout-section">
            <div class="container checkout-container" style="margin-top:120px;">
                <h1>Pilih Barang untuk Checkout</h1>

                
                <!-- Keranjang Belanja -->
                <table class="table mt-5" style="border-spacing: 0 10px; border-color: transparent;">
                    <thead>
                        <tr>
                            <th>Gambar</th>
                            <th>Nama Barang</th>
                            <th>Jumlah</th>
                            <th>Harga Satuan</th>
                            <th>Total Harga Barang</th>
                            <th>Aksi</th>
                            <th style="display: flex; justify-content:space-around">
                                Pilih Semua
                                <input type="checkbox" id="select-all" onchange="toggleSelectAll()">
                            </th>
                        </tr>
                    </thead>
                    <tbody>
                                                    <tr>
                                <td style="text-align: center;">
                                    <img src="images/1731897963_673aaa6b638a6.png" alt="Product Image"
                                        style="width: 100px; height: 100px; object-fit: contain;">
                                </td>
                                <td>Baju Ospek</td>
                                <td>1</td>
                                <td>Rp. 68.000</td>
                                <td>Rp. 68.000</td>
                                <td>
                                    <form id="delete-cart-15"
                                        action="user/checkout/delete/15" method="POST">
                                        <input type="hidden" name="_token" value="jhGnK4mUzq5jKoSbVALk1WGiTUc5g0agt5G0rwBg" autocomplete="off">                                        <input type="hidden" name="_method" value="DELETE">                                        <button class="btn delete-cart-button" type="button"
                                            data-form-id="delete-cart-15">Hapus
                                        </button>
                                    </form>
                                </td>
                                <td>
                                    <input type="checkbox" class="cart-checkbox" data-id="1"
                                        data-price="68000" data-quantity="1"
                                        onchange="updateTotal()">
                                </td>
                            </tr>
                                            </tbody>
                </table>
            </div>

            <div class="checkout-total-bar">
                <button type="button" class="btn" id="pay-button">Lanjutkan Pembayaran</button>
                <h3 class="ml-4">Total Harga: Rp. <span id="total-price">0</span></h3>
            </div>
        </div>

        <form id="recipientForm" action="user/checkout" method="POST">
            <input type="hidden" name="_token" value="jhGnK4mUzq5jKoSbVALk1WGiTUc5g0agt5G0rwBg" autocomplete="off">            <input type="hidden" id="selected_products" name="selected_products">
        </form>
        <form id="handleback" action="user/midtrans/callback" method="POST">
            <input type="hidden" name="_token" value="jhGnK4mUzq5jKoSbVALk1WGiTUc5g0agt5G0rwBg" autocomplete="off">            <input type="hidden" id="json_callback" name="json">
        </form>
        


        <!--===============================================================================================-->
    <script src="vendor/jquery/jquery-3.2.1.min.js"></script>
    <!--===============================================================================================-->
    <script src="vendor/animsition/js/animsition.min.js"></script>
    <!--===============================================================================================-->
    <script src="vendor/bootstrap/js/popper.js"></script>
    <script src="vendor/bootstrap/js/bootstrap.min.js"></script>
    <!--===============================================================================================-->
    <script src="vendor/select2/select2.min.js"></script>
    <script>
        $(".js-select2").each(function() {
            $(this).select2({
                minimumResultsForSearch: 20,
                dropdownParent: $(this).next('.dropDownSelect2')
            });
        })
    </script>
    <!--===============================================================================================-->
    <script src="vendor/daterangepicker/moment.min.js"></script>
    <script src="vendor/daterangepicker/daterangepicker.js"></script>
    <!--===============================================================================================-->
    <script src="vendor/slick/slick.min.js"></script>
    <script src="js/slick-custom.js"></script>
    <!--===============================================================================================-->
    <script src="vendor/parallax100/parallax100.js"></script>
    <script>
        $('.parallax100').parallax100();
    </script>
    <!--===============================================================================================-->
    <script src="vendor/MagnificPopup/jquery.magnific-popup.min.js"></script>
    <script>
        $('.gallery-lb').each(function() { // the containers for all your galleries
            $(this).magnificPopup({
                delegate: 'a', // the selector for gallery item
                type: 'image',
                gallery: {
                    enabled: true
                },
                mainClass: 'mfp-fade'
            });
        });
    </script>
    <!--===============================================================================================-->
    <script src="vendor/isotope/isotope.pkgd.min.js"></script>
    <!--===============================================================================================-->
    <script src="vendor/sweetalert/sweetalert.min.js"></script>
    <script>
        // Menangani klik pada tombol tambah ke wishlist
        $('.js-addwish-b2').each(function() {
            var nameProduct = $(this).parent().parent().find('.js-name-b2').html();
            $(this).on('click', function(e) {
                e.preventDefault();
                swal(nameProduct, "is added to wishlist!", "success");
                $(this).addClass('js-addedwish-b2');
                $(this).off('click');
            });
        });
    
        // Menangani klik pada tombol tambah ke wishlist di detail produk
        $('.js-addwish-detail').each(function() {
            var nameProduct = $(this).parent().parent().parent().find('.js-name-detail').html();
            $(this).on('click', function() {
                swal(nameProduct, "is added to wishlist!", "success");
                $(this).addClass('js-addedwish-detail');
                $(this).off('click');
            });
        });
    
        // Menangani klik pada tombol tambah ke keranjang
        $('.js-addcart-detail').each(function() {
            var nameProduct = $(this).closest('.product-list').find('.name-product').html();
            $(this).on('click', function(e) {
                e.preventDefault(); // Mencegah formulir dikirim langsung
    
                // Tampilkan SweetAlert
                swal({
                    title: nameProduct,
                    text: "is added to cart!",
                    icon: "success",
                    button: "OK",
                }).then(() => {
                    // Kirim formulir setelah pengguna menekan tombol OK
                    $(this).closest('form').submit();
                });
            });
        });
    </script>
    
    <!--===============================================================================================-->
    <script src="vendor/perfect-scrollbar/perfect-scrollbar.min.js"></script>
    <script>
        $('.js-pscroll').each(function() {
            $(this).css('position', 'relative');
            $(this).css('overflow', 'hidden');
            var ps = new PerfectScrollbar(this, {
                wheelSpeed: 1,
                scrollingThreshold: 1000,
                wheelPropagation: false,
            });

            $(window).on('resize', function() {
                ps.update();
            })
        });
    </script>
    <!--===============================================================================================-->
    <script src="js/main.js"></script>
    <script src="js/sekerip.js"></script>
</body>

</html>
        <script>
            let selectedProducts = []; // Deklarasikan variabel secara global

            function toggleSelectAll() {
                const selectAll = document.getElementById("select-all");
                const checkboxes = document.querySelectorAll(".cart-checkbox");
                checkboxes.forEach((checkbox) => {
                    checkbox.checked = selectAll.checked;
                });
                updateTotal();
            }

            function updateTotal() {
                const checkboxes = document.querySelectorAll(".cart-checkbox:checked");
                let totalPrice = 0;
                selectedProducts = []; // Reset daftar produk yang dipilih

                checkboxes.forEach((checkbox) => {
                    const productId = checkbox.getAttribute("data-id");
                    const price = parseFloat(checkbox.getAttribute("data-price"));
                    const quantity = parseInt(checkbox.getAttribute("data-quantity"));
                    totalPrice += price * quantity;

                    selectedProducts.push({
                        product_id: productId,
                        quantity: quantity,
                        price: price
                    });
                });

                document.getElementById("total-price").innerText = totalPrice.toLocaleString("id-ID");
                document.getElementById("selected_products").value = JSON.stringify(selectedProducts);
            }

            document.getElementById('pay-button').addEventListener('click', function() {
                if (selectedProducts.length === 0) {
                    alert('Pilih minimal satu barang untuk melanjutkan.');
                    return;
                }
                document.getElementById('recipientForm').submit();
            });


                    </script>
    </body>
